{% extends 'step_wizard.html' %}

{% block page_title %} Questionnaire {% endblock %}
{% block page_scss %}
    {{ block.super }}
    <link href="/media/css/scss/section_questionnaire.scss" rel="stylesheet" />
{% endblock %}
{% block page_js %}
    {{ block.super }}
    <script type="text/javascript" src="/media/javascript/project/view_model.js"></script>
    <script type="text/javascript" src="/media/javascript/project/questionnaire.js"></script>
    <script type="text/javascript" src="/media/javascript/csrf_token_handler.js"></script>
    <script type="text/javascript">
        var question_list = JSON.parse('{{existing_questions|safe}}');
        $(document).ready(function(){
            $("#tab_items .questionnaire").addClass("current");
            set_current_tab();
        })
    </script>
    <script type="text/html" id="choice-template">
        <li>
        <p>
            <input data-bind="value: text"/>
            <a href="questionnaire.html#" data-bind="click:function(){viewModel.removeOptionFromQuestion($data)}">Delete</a>
        </p>
        </li>
    </script>
    <script type="text/html" id="question-list-template">
        <div class="question_list">
            <ol>
            {% templatetag openvariable %}each(i,question) questions{% templatetag closevariable %}
             <li>
                <a href="questionnaire.html#"
                   data-bind="text: question.display, click: function() { if($('#question_form').valid()) viewModel.changeSelectedQuestion(question); } ">
                </a>
             <div>
                 <span data-bind="visible: question.canBeDeleted()" class="delete">
                     <a href="questionnaire.html#" data-bind="click: function() {if($('#question_form').valid()) viewModel.removeQuestion(question); }">Delete</a>
                </span>
              </div>
             </li>

            {% templatetag openvariable %}/each{% templatetag closevariable %}
            </ol>
        </div>
    </script>
{% endblock %}


{% block step_number %}
    <h3>Step2: Questionnaire</h3>
    <p>Description about the step goes here</p>
{% endblock %}
{% block content %}
    {% csrf_token %}
    <ul class="questionnaire_code">
         <li>
            <h5>Your Questionnaire</h5>
            <label>Questionnaire Code :</label>
            <input id='project-id' type='hidden' value={{ project_id }} />
            <input id='questionnaire-code' class='required' value={{ questionnaire_code }} />
             <span id="questionnaire-code-error"/>
        </li>
    </ul>
    <div class="questionnare_header grid_22 alpha omega">Header</div>
    <div class="questionnare_content grid_22 alpha omega">
        <div id="message-label">
        </div>

        <div>
            <div id="questions-panel" class="grid_8">
                <div data-bind="template: 'question-list-template'" class="">
                </div>
                <div class="add_question">
                    <a href="questionnaire.html#"
                       data-bind="click: function() { if($('#question_form').valid()) viewModel.addQuestion();}">Add
                        a Question</a>
                </div>
            </div>

            <div id="question-detail-panel" class="grid_11">
                <form id="question_form">
                    <fieldset>
                        <legend>Add Questionnaire</legend>
                        <ul>
                            <li>
                                <label>Question</label>
                                <input id="question" name="question" type="text" class="required"
                                       data-bind="value: selectedQuestion().title"/>
                            </li>
                            <li>
                                <label>Code</label>
                                <input id="code" name="code" type="text" class="required"
                                       data-bind="value: selectedQuestion().question_code"/>
                            </li>
                            <li class="margin_null" data-bind="visible: !selectedQuestion().is_entity_question()">
                                <label>Type</label>

                                <div><input type="radio" name="type" value="text"
                                            data-bind="checked: selectedQuestion().type" class="required"/> Word or Phrase
                                </div>
                                <div><input type="radio" name="type" value="integer"
                                            data-bind="checked: selectedQuestion().type" class="required"/> Number
                                </div>
                                <div><input type="radio" name="type" value="date"
                                            data-bind="checked: selectedQuestion().type" class="required"/> Date
                                </div>
                                <div><input type="radio" name="type" value="choice"
                                            data-bind="checked: selectedQuestion().isAChoiceTypeQuestion"
                                            class="choice-question-checkbox required"/> List of Choices
                                </div>
                            </li>
                            <li data-bind="visible: viewModel.showDateFormats()">
                                <div class="margin_top_20">
                                    <p>
                                        <label>Select Date Format</label>
                                    </p>
                                    <p>
                                    <input type="radio" name="date_format" value="mm.yyyy"
                                           data-bind="checked:selectedQuestion().date_format" />
                                    month.year (mm.yyyy)<br/>
                                    <input type="radio" name="date_format" value="dd.mm.yyyy"
                                           data-bind="checked:selectedQuestion().date_format" />
                                    date.month.year (dd.mm.yyyy)<br/>
                                    <input type="radio" name="date_format" value="mm.dd.yyyy"
                                           data-bind="checked:selectedQuestion().date_format" />
                                    month.date.year (mm.dd.yyyy)<br/>
                                    </p>
                                </div>
                            </li>
                            <li data-bind="visible: viewModel.showAddChoice()">
                                <div class="margin_top_20">
                                    <ol class="alpha_list" data-bind="template: { name : 'choice-template',foreach : selectedQuestion().choices }">

                                    </ol>
                                    <a href="questionnaire.html#" data-bind="click: function() { viewModel.addOptionToQuestion(); }">Add
                                        Choice</a>
                                </div>
                                <div>
                                    <input type="radio" name="answers_possible" value="select1"
                                           data-bind="checked:selectedQuestion().type" />
                                    only one answer<br/>
                                    <input type="radio" name="answers_possible" value="select"
                                           data-bind="checked:selectedQuestion().type" />
                                    multiple answers are permitted<br/>
                                </div>
                            </li>
                            <li data-bind="visible: viewModel.showAddRange()">
                                <div class="margin_top_20">
                                    <p>
                                        Min:
                                        <input name="range_min" type="text" id="range_min" data-bind="value:selectedQuestion().range_min"/>
                                    </p>

                                    <p>
                                        Max:
                                        <input name="range_max" type="text" id="range_max" data-bind="value:selectedQuestion().range_max"/>
                                    </p>
                                </div>
                            </li>
                            <li data-bind="visible: viewModel.showAddTextLength() && !selectedQuestion().is_entity_question()">
                                <div class="margin_top_20">
                                    <input type="radio" name="text_length" value="length_unlimited" checked = "true" data-bind="checked:selectedQuestion().length_limiter" />
                                    No, answer has no character limit<br/>
                                    <div class="max_char">
                                        <input type="radio"  name="text_length" value="length_limited" data-bind="checked:selectedQuestion().length_limiter" />
                                        <span class="inline">
                                            Yes, maximum number of characters should be
                                            <input name="max_length"  type="text"  id="max_length" data-bind="value:selectedQuestion().max_length, visible: viewModel.showLengthLimiter()"/>
                                        </span>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </fieldset>
                </form>
            </div>
            <div>
            </div>
        </div>
    </div>
{% endblock %}
{% block buttons %}
        <a href="questionnaire.html#" class="cancel">Cancel</a>
        <input id="submit-button" type="button" value="Save Questionnaire"/>
{% endblock %}


