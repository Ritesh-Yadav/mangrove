{% extends 'step_wizard.html' %}

{% block page_title %} Create a Questionnaire {% endblock %}
{% block page_js %}
    {{ block.super }}
    <script type="text/javascript" src="/media/javascript/questionnaire.js"></script>
    <script type="text/javascript" src="/media/javascript/csrf_token_handler.js"></script>
    <script type="text/javascript">
        var question_list = JSON.parse('{{existing_questions|safe}}');
        $(document).ready(function(){
            $("#tab_items .questionnaire").addClass("current");
            set_current_tab();
        })


    </script>
    <script type="text/html" id="choice-template">
        <p>
            <input data-bind="value: value"/>
            <a href="#" data-bind="click:function(){viewModel.removeOptionFromQuestion($data)}">Delete</a>
        </p>
    </script>
    <script type="text/html" id="question-list-template">
        <div class="question_list">
            <ol>
            {% templatetag openvariable %}each(i,question) questions{% templatetag closevariable %}
             <li>
                <a href="#"
                   data-bind="text: question.display, click: function() { viewModel.changeSelectedQuestion(question); } ">
                </a>
             <div>
                 <span data-bind="visible: question.canBeDeleted()" class="delete">
                     <a href="#" data-bind="click: function() { viewModel.removeQuestion(question); }">Delete</a>
                </span>
              </div>
             </li>

            {% templatetag openvariable %}/each{% templatetag closevariable %}
            </ol>
        </div>
    </script>
{% endblock %}


{% block step_number %}
    <h3>Step2: Questionnaire</h3>
    <p>Description about the step goes here</p>
{% endblock %}
{% block content %}
    {% csrf_token %}
    <ul class="questionnaire_code">
         <li>
            <h5>Your Questionnaire</h5>
            <label>Questionnaire Code :</label>
            <input id='questionnaire-code'/>
        </li>
    </ul>
    <div class="questionnare_header">Header</div>
    <div class="questionnare_content">
        <div id="message-label">
        </div>

        <div>
            <div id="questions-panel" class="grid_8">
                <div data-bind="template: 'question-list-template'" class="">
                </div>
                <div class="add_question">
                    <a href="#"
                       data-bind="click: function() {$('#question_form').validate(); if($('#question_form').valid()) viewModel.addQuestion();}">Add
                        a Question</a>
                </div>
            </div>

            <div id="question-detail-panel" class="grid_11">
                <form id="question_form">
                    <fieldset>
                        <legend>Add Questionnaire</legend>
                        <ul>
                            <li>
                                <label>Question</label>
                                <input id="question" name="question" type="text" class="required"
                                       data-bind="value: selectedQuestion().title"/>
                            </li>
                            <li>
                                <label>Code</label>
                                <input id="code" name="code" type="text" class="required"
                                       data-bind="value: selectedQuestion().code"/>
                            </li>
                            <li>
                                <label>Description</label>
                                <textarea data-bind="value: selectedQuestion().description" ></textarea>
                            </li>
                            <li class="margin_null">
                                <label>Type</label>

                                <div><input type="radio" name="type" value="text"
                                            data-bind="checked: selectedQuestion().type" class="required"/> Word or Phrase
                                </div>
                                <div><input type="radio" name="type" value="integer"
                                            data-bind="checked: selectedQuestion().type" class="required"/> Number
                                </div>
                                <div><input type="radio" name="type" value="choice"
                                            data-bind="checked: selectedQuestion().type,click:function(){ viewModel.clearChoices(); return true;}"
                                            class="choice-question-checkbox required"/> List of Choices
                                </div>
                            </li>
                            <li data-bind="visible: viewModel.showAddChoice()">
                                <div>
                                    <div data-bind="template: { name : 'choice-template',foreach : selectedQuestion().choices }">
                                    </div>
                                    <a href="#" data-bind="click: function() { viewModel.addOptionToQuestion(); }">Add
                                        Choice</a>
                                </div>
                                <div>
                                    <input type="radio" name="answers_possible" value="single"
                                           data-bind="checked:selectedQuestion().answers_permitted" />
                                    only one answer<br/>
                                    <input type="radio" name="answers_possible" value="multiple"
                                           data-bind="checked:selectedQuestion().answers_permitted" />
                                    multiple answers are permitted<br/>
                                </div>
                            </li>
                            <li data-bind="visible: viewModel.showAddRange()">
                                &nbsp;
                                <div>
                                    <p>
                                        Min:
                                        <input name="range_min" data-bind="value:selectedQuestion().range_min"/>
                                    </p>

                                    <p>
                                        Min:
                                        <input name="range_max" data-bind="value:selectedQuestion().range_max"/>
                                    </p>
                                </div>
                            </li>
                        </ul>
                    </fieldset>
                </form>
            </div>
            <div>
            </div>
        </div>
    </div>
{% endblock %}
{% block buttons %}
        <a href="#" class="cancel">Cancel</a>
        <input id="submit-button" type="button" value="Save Questionnaire"/>
{% endblock %}



